<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Reaction–Diffusion (CPU-only, WebGL不要)</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22black%22/></svg>">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Reaction–Diffusion (Gray–Scott) — CPU専用</h1>
    <p class="sub">WebGL1/2が無くても動作します。ドラッグで局所注入。PNG保存可。</p>
  </header>

  <main>
    <div class="canvas-wrap">
      <div class="canvas-wrap">
  <div class="canvas-square">
    <canvas id="view"></canvas>
  </div>
</div>
    </div>

    <section class="controls">
      <div class="row">
        <label>解像度:
          <select id="res">
            <option value="256">256</option>
            <option value="384">384</option>
            <option value="512" selected>512</option>
            <option value="640">640</option>
            <option value="768">768</option>
          </select>
        </label>
        <label>速度:
          <input id="speed" type="range" min="1" max="8" value="2">
        </label>
        <button id="reset">リセット</button>
        <button id="seed">強注入</button>
        <button id="save">PNG保存</button>
      </div>
      <div class="row grid">
        <label>F: <input id="F" type="range" min="0.0" max="0.08" value="0.036" step="0.0005"><span id="Fv"></span></label>
        <label>k: <input id="k" type="range" min="0.0" max="0.07" value="0.060" step="0.0005"><span id="kv"></span></label>
        <label>Du: <input id="Du" type="range" min="0.05" max="0.4" value="0.16" step="0.005"><span id="Duv"></span></label>
        <label>Dv: <input id="Dv" type="range" min="0.01" max="0.2" value="0.08" step="0.005"><span id="Dvv"></span></label>
        <label>dt: <input id="dt" type="range" min="0.2" max="2.0" value="1.0" step="0.1"><span id="dtv"></span></label>
      </div>
      <details>
        <summary>表示</summary>
        <div class="row grid">
          <label>コントラスト<input id="contrast" type="range" min="0.5" max="3.0" step="0.05" value="1.6"></label>
          <label>明度<input id="brightness" type="range" min="-0.5" max="0.5" step="0.05" value="0.0"></label>
          <label>反転<input id="invert" type="checkbox"></label>
        </div>
      </details>
      <p class="hint">ヒント: 起動直後は全域ランダム微注入＋中央強注入で、すぐ模様が立ち上がります。</p>
    </section>
  </main>

  <footer>
    <small>CPU実装 / 最適化：ライン更新 + ルックアップ簡略化 / 2025-11-08</small>
  </footer>

  <script src="rd_cpu.js"></script>
</body>
</html>
